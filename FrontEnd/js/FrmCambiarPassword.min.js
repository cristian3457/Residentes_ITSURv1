function cambiarPassword(a) { var o = "{'info' : '" + JSON.stringify(a) + "'}"; $.ajax({ type: "POST", url: "ws/WSUsuarios.asmx/updatePassword", data: o, contentType: "application/json; utf-8", dataType: "json", success: function (a) { a.d ? ($("#mdlInformacion").modal("show"), window.sessionStorage.removeItem("email")) : ($("#msgError").text("HA OCURRIDO UN ERROR, POR FAVOR VUELVELO A INTENTAR"), $("#mdlError").modal().show()) }, error: function (a, o, e) { "System.Exception" == a.responseJSON.ExceptionType ? ($("#msgError").text(a.responseJSON.Message), $("#mdlError").modal().show()) : "System.Security.SecurityException" == a.responseJSON.ExceptionType && Response.load("FrmLogin.aspx") } }) } $(document).ready(function () { var a = document.getElementById("contenido_txtPassword"), o = document.getElementById("contenido_txtConfirmarPassword"); a.value.trim(), o.value.trim(); $("#btncambiar").click(function () { if ($("#FrmCambiarPassword").data("bootstrapValidator").validate(), $("#FrmCambiarPassword").data("bootstrapValidator").isValid()) { var a = $("#contenido_txtEmailUsuario").val(), o = ($("#contenido_txtTipoUsuario").val(), $("#contenido_txtPassword").val()); if (null != a) { let e = {}; e.email = a, e.password = o, cambiarPassword(e) } } else $("#mdlValidacionCampos").modal("show") }), $("#FrmCambiarPassword").bootstrapValidator({ framework: "bootstrap", excluded: [":disabled", ":hidden"], fields: { ctl00$contenido$txtPassword: { message: "Contraseña no valida", validators: { notEmpty: { message: "Este campo es obligatorio y no debe estar vacio." }, identical: { field: "ctl00$contenido$txtConfirmarPassword", message: "Las contraseñas no coinciden." }, regexp: { regexp: /(?=^.{8,16}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/, message: "La contraseña Debe tener entre 8 y 16 caracteres, al menos un dígito, al menos una minúscula, al menos una mayúscula" } } }, ctl00$contenido$txtConfirmarPassword: { message: "Contraseña no valida", validators: { notEmpty: { message: "Este campo es obligatorio y no debe estar vacio." }, identical: { field: "ctl00$contenido$txtPassword", message: "Las contraseñas no coinciden." }, regexp: { regexp: /(?=^.{8,16}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/, message: "La contraseña Debe tener entre 8 y 16 caracteres, al menos un dígito, al menos una minúscula, al menos una mayúscula" } } } } }), $("#btnAceptarInfo").click(function () { window.location.assign("FrmContenedor.aspx") }), $("#btncancelar").click(function () { window.sessionStorage.removeItem("email"), window.location.assign("FrmContenedor.aspx") }) });