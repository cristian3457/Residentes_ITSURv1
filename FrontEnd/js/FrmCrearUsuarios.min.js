function cargarDatos(e){var a="{ 'id_usuario' : '"+parseInt(e)+"'}";$.ajax({type:"POST",url:"ws/WSUsuarios.asmx/getOne",data:a,contentType:"application/json; utf-8",dataType:"json",success:function(e){let a=JSON.parse(e.d);$("#contenido_txtEmail").val(a[0].email)},error:function(e,a,o){"System.Exception"==e.responseJSON.ExceptionType?($("#msgError").text(e.responseJSON.Message),$("#mdlError").modal().show()):"System.Security.SecurityException"==e.responseJSON.ExceptionType&&Response.load("FrmLogin.aspx")}})}function crearUsuario(e){var a="{'info' : '"+JSON.stringify(e)+"'}";$.ajax({type:"POST",url:"ws/WSUsuarios.asmx/insert",data:a,contentType:"application/json; utf-8",dataType:"json",success:function(e){e.d>0&&$("#mdlInformacion").modal("show")},error:function(e,a,o){"System.Exception"==e.responseJSON.ExceptionType?($("#msgError").text(e.responseJSON.Message),$("#mdlError").modal().show()):"System.Security.SecurityException"==e.responseJSON.ExceptionType&&Response.load("FrmLogin.aspx")}})}function actualizarUsuario(e){var a="{'info' : '"+JSON.stringify(e)+"'}";$.ajax({type:"POST",url:"ws/WSUsuarios.asmx/update",data:a,contentType:"application/json; utf-8",dataType:"json",success:function(e){e.d&&$("#mdlInformacion").modal("show")},error:function(e,a,o){"System.Exception"==e.responseJSON.ExceptionType?($("#msgError").text(e.responseJSON.Message),$("#mdlError").modal().show()):"System.Security.SecurityException"==e.responseJSON.ExceptionType&&Response.load("FrmLogin.aspx")}})}$(document).ready(function(){var e=document.getElementById("contenido_txtEmail"),a=document.getElementById("contenido_ddlTipoUsuario"),o=document.getElementById("contenido_txtPassword"),s=document.getElementById("contenido_txtConfirmarPassword");new RegExp("^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.([a-zA-Z]{2,4})+$"),o.value.trim(),s.value.trim(),e.value.trim(),a.value;$("#btncrear").click(function(){if($("#FrmCrearUsuarios").data("bootstrapValidator").validate(),$("#FrmCrearUsuarios").data("bootstrapValidator").isValid()){var e=$("#contenido_txtEmail").val(),a=$("#contenido_txtPassword").val(),o=$("#contenido_ddlTipoUsuario").val(),s=window.sessionStorage.getItem("id_usuario");let n={};n.email=e,n.password=a,n.tipo_usuario=o;var t=document.getElementById("btncrear");if("Registrar"==t.value)crearUsuario(n);else if("Editar"==t.value){let t={};t.id_usuario=s,t.email=e,t.password=a,t.tipo_usuario=o,actualizarUsuario(t)}}else $("#mdlValidacionCampos").modal("show")}),$("#FrmCrearUsuarios").bootstrapValidator({framework:"bootstrap",excluded:[":disabled",":hidden"],fields:{ctl00$contenido$txtEmail:{message:"Email no valido",validators:{notEmpty:{message:"Este campo es obligatorio y no debe estar vacio."},regexp:{regexp:/^([\w-]+\.)*?[\w-]+@[\w-]+\.([\w-]+\.)*?[\w]+$/,message:"El Email no es valido un ejmeplo es: ejemplo@emplo.com"}}},ctl00$contenido$txtPassword:{message:"Contraseña no valida",validators:{notEmpty:{message:"Este campo es obligatorio y no debe estar vacio."},identical:{field:"ctl00$contenido$txtConfirmarPassword",message:"Las contraseñas no coinciden"},regexp:{regexp:/(?=^.{8,16}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,message:"La contraseña Debe tener entre 8 y 16 caracteres, al menos un dígito, al menos una minúscula, al menos una mayúscula"}}},ctl00$contenido$txtConfirmarPassword:{message:"Contraseña no valida",validators:{notEmpty:{message:"El Campo es obligatorio"},identical:{field:"ctl00$contenido$txtPassword",message:"Las contraseñas no coinciden"},regexp:{regexp:/(?=^.{8,16}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,message:"La contraseña Debe tener entre 8 y 16 caracteres, al menos un dígito, al menos una minúscula, al menos una mayúscula"}}},ctl00$contenido$ddlTipoUsuario:{message:"Tipo de usuario no valido",validators:{notEmpty:{message:"Es necesario indicar el tipo de usuario"},callback:{message:"El tipo de usuario no es válido",callback:function(e,a,o){return"Empresa"==e||"Administrador"==e}}}}}});var t=window.sessionStorage.getItem("id_usuario");null!=t&&($("#tituloUsuarios").text("EDITAR DATOS DE USUARIO"),$("#btncrear").val("Editar"),cargarDatos(t)),$("#btnAceptarInfo").click(function(){$("#divContenido").load("FrmGestionarUsuarios.aspx")}),$("#btncancelar").click(function(){window.sessionStorage.removeItem("id_usuario"),$("#divContenido").load("FrmGestionarUsuarios.aspx")})});